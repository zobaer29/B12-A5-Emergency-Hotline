<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- tailwind css cdn  -->
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <!-- daisy ui link  -->
  <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css" />
  <!-- font awesome cdn  -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css"
    integrity="sha512-DxV+EoADOkOygM4IR9yXP8Sb2qwgidEmeqAEmDKIOfPRQZOWbXCzLC6vjbZyy0vPisbH2SyW27+ddLVCN+OMzQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <title>Emergency Hotline</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .service-card {
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .service-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    .heart-animation {
      animation: pulse 0.5s;
    }
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.3); }
      100% { transform: scale(1); }
    }
  </style>
</head>

<body class="bg-gray-50">
  <header>
    <!-- navbar start  -->
    <nav class="flex flex-col md:flex-row justify-between items-center mx-5 py-5">
      <div class="flex items-center gap-2 mb-2 md:mb-0">
        <img class="w-[50px]" src="assets/logo.png" alt="Emergency Service Logo">
        <h4 class="md:text-xl text-sm text-green-900 font-bold">Emergency <br> Service</h4>
      </div>
      <div class="flex justify-center items-center gap-1 md:gap-4 text-xs md:text-sm">
        <div class="flex items-center justify-center gap-2 px-4 py-2 bg-green-100 rounded-3xl">
          <p id="heart-count" class="font-bold">0</p>
          <img class="w-[25px]" src="assets/heart.png" alt="Heart Icon">
        </div>
        <div class="flex items-center justify-center gap-2 px-4 py-2 bg-green-100 rounded-3xl">
          <p id="coin" class="font-bold">100</p>
          <img class="w-[24px]" src="assets/coin.png" alt="Coin Icon">
        </div>
        <div class="flex items-center justify-center gap-2 px-4 py-2 text-white bg-[#2faf5e] rounded-3xl">
          <p id="copy-count" class="font-bold">0</p>
          <p class="font-bold">Copy</p>
        </div>
      </div>
    </nav>
    <!-- nav end  -->

    <!-- banner start  -->
    <div class="text-center py-10 bg-gradient-to-r from-green-950 via-green-800 to-green-950 text-white">
      <img src="assets/logo.png" alt="govt logo" class="w-16 h-16 mx-auto mb-2">
      <h1 class="text-2xl font-bold">জরুরি সেবা ডিরেক্টরি</h1>
      <p class="text-sm mt-1 px-4">
        Government Emergency Services at Your Fingertip – A Project by Government of the People’s Republic of Bangladesh
      </p>
    </div>
    <!-- banner end  -->
  </header>

  <main class="p-4 sm:p-6 grid grid-cols-1 lg:grid-cols-4 gap-4 sm:gap-6 max-w-7xl mx-auto">
    <!-- Cards Section -->
    <section id="cards" class="lg:col-span-3 grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6">
      <!-- Cards will be generated dynamically -->
    </section>

    <!-- History Section -->
    <aside class="lg:col-span-1">
      <div class="bg-white rounded-2xl shadow p-4 sm:p-6 sticky top-6">
        <h2 class="font-bold text-lg sm:text-xl mb-4">Recent Calls</h2>
        <ul id="historyList" class="space-y-2 max-h-96 overflow-y-auto text-sm sm:text-base">
          <!-- History items will be added here -->
        </ul>
        <button id="clearHistory" class="mt-4 w-full bg-red-100 hover:bg-red-200 text-red-700 py-2 rounded">
          Clear History
        </button>
      </div>
    </aside>
  </main>

  <div id="toast" class="fixed bottom-4 right-4 bg-gray-800 text-white px-4 py-2 rounded-lg shadow-lg opacity-0 transition-opacity duration-300">
    <span id="toast-message"></span>
  </div>


</html>

<script>
   const emergencyServices = [
      {
        id: 1,
        name: "জাতীয় জরুরি সেবা",
        description: "National Emergency",
        number: "999",
        category: "সার্বজনীন",
        icon: "assets/emergency.png"
      },
      {
        id: 2,
        name: "পুলিশ",
        description: "Police",
        number: "999",
        category: "পুলিশ",
        icon: "assets/police.png"
      },
      {
        id: 3,
        name: "ফায়ার সার্ভিস",
        description: "Fire Service",
        number: "999",
        category: "ফায়ার",
        icon: "assets/fire-service.png"
      },
     
      {
        id: 4,
        name: "অ্যাম্বুলেন্স",
        description: "Ambulance",
        number: "1994-999999",
        category: "স্বাস্থ্য",
        icon: "assets/ambulance.png"
      },
      
      {
        id: 5,
        name: "নারী ও শিশু সহায়তা",
        description: "Women & Child Helpline",
        number: "109",
        category: "সহায়তা",
        icon: "assets/emergency.png"
      },
      {
        id: 6,
        name: "দুদক",
        description: "anti-Corruption",
        number: "106",
        category: "সরকারি",
         icon: "assets/emergency.png"
      },
      {
        id: 7,
        name: "বিদ্যুৎ বিভ্রাট",
        description: "Electricity Outage",
        number: "16216",
        category: "বিদ্যুৎ",
        icon: "assets/emergency.png"
      },
      {
        id: 8,
        name: "ব্রাক",
        description: "BRAC",
        number: "16445",
        category: "এনজিও",
        icon: "assets/brac.png"
      },
      {
        id: 9,
        name: "বাংলাদেশ রেলওয়ে",
        description: "Bangladesh Railway",
        number: "163",
        category: "পরিবহন",
        icon: "assets/Bangladesh-Railway.png"
        }
    ];
     // State management
    let state = {
      heartCount: 0,
      coinCount: 100,
      copyCount: 0,
      callHistory: []
    };

    // DOM Elements
    const heartsEl = document.getElementById('heart-count');
    const coinsEl = document.getElementById('coin');
    const copiesEl = document.getElementById('copy-count');
    const cardsEl = document.getElementById('cards');
    const historyList = document.getElementById('historyList');
    const clearBtn = document.getElementById('clearHistory');
    const toastEl = document.getElementById('toast');
    const toastMessage = document.getElementById('toast-message');

 // Initialize the app
function init() {
  renderCards();
  loadFromLocalStorage(); 
  updateUI();             
}


    // Render emergency service cards
    function renderCards() {
      cardsEl.innerHTML = emergencyServices.map(service => `
        <article class="service-card bg-white rounded-2xl shadow p-4 text-sm sm:text-base">
          <div class="flex items-start justify-between">
            <div class="flex items-center gap-3">
              <img src="${service.icon}" alt="${service.name}" class="w-8 h-8 sm:w-10 sm:h-10">
              <div>
                <h2 class="font-bold leading-tight text-base sm:text-lg">${service.name}</h2>
                <p class="text-xs sm:text-sm text-gray-500 -mt-0.5">${service.description}</p>
              </div>
            </div>
            <button class="heart-btn text-lg sm:text-xl" aria-label="like this service" data-id="${service.id}" title="Like">
              <i class="far fa-heart"></i>
            </button>
          </div>

          <div class="mt-3">
            <div class="text-xl sm:text-2xl font-bold tracking-tight">${service.number}</div>
            <div class="mt-2 inline-flex items-center text-xs sm:text-sm px-2 py-1 rounded-full bg-gray-100 text-gray-600">
              ${service.category}
            </div>
          </div>

          <div class="mt-4 flex flex-col sm:flex-row gap-2">
            <button
              class="copy-btn bg-gray-200 hover:bg-gray-300 px-3 py-2 rounded flex items-center justify-center gap-2 w-full sm:w-auto"
              data-name="${service.name}" data-phone="${service.number}" title="Copy number">
              <i class="far fa-copy"></i> <span>Copy</span>
            </button>
            <button
              class="call-btn bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded flex items-center justify-center gap-2 w-full sm:w-auto"
              data-name="${service.name}" data-phone="${service.number}" title="Call number">
              <i class="fas fa-phone"></i> <span>Call</span>
            </button>
          </div>
        </article>
      `).join('');
    }

    // Update UI with current state
    function updateUI() {
      heartsEl.textContent = state.heartCount;
      coinsEl.textContent = state.coinCount;
      copiesEl.textContent = state.copyCount;
      renderHistory();
    }

    // Render call history
    function renderHistory() {
      if (state.callHistory.length === 0) {
        historyList.innerHTML = '<li class="text-gray-500 text-center py-4">No call history yet</li>';
        return;
      }

      historyList.innerHTML = state.callHistory.map(item => `
        <li class="flex items-center justify-between gap-3 py-2 border-b border-gray-100">
          <div class="truncate">
            <p class="font-medium truncate">${item.name}</p>
            <p class="text-gray-500 text-sm">${item.phone}</p>
          </div>
          <span class="shrink-0 text-gray-500 text-xs">${item.time}</span>
        </li>
      `).join('');
    }
 // Show toast notification
    function showToast(message, isError = false) {
      toastMessage.textContent = message;
      toastEl.style.backgroundColor = isError ? '#ef4444' : '#16a34a';
      toastEl.classList.remove('opacity-0');
      toastEl.classList.add('opacity-100');
      
      setTimeout(() => {
        toastEl.classList.remove('opacity-100');
        toastEl.classList.add('opacity-0');
      }, 3000);
    }

    // Add to call history
    function addHistory(name, phone) {
      const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
      state.callHistory.unshift({ name, phone, time });
      
      // Keep only last 10 history items
      if (state.callHistory.length > 10) {
        state.callHistory.pop();
      }
      
      renderHistory();
      saveToLocalStorage();
    }

    // Save state to localStorage
    function saveToLocalStorage() {
      localStorage.setItem('emergencyAppState', JSON.stringify(state));
    }

// Load state from localStorage
function loadFromLocalStorage() {
  const savedState = localStorage.getItem('emergencyAppState');
  if (savedState) {
    const parsed = JSON.parse(savedState);
    state = { ...state, ...parsed };
  } else {
    // ✅ First run, ensure defaults
    state = {
      heartCount: 0,
      coinCount: 100,
      copyCount: 0,
      callHistory: []
    };
    saveToLocalStorage();
  }
  updateUI();
}


    // Event listeners
    document.addEventListener('click', async (e) => {
      const target = e.target.closest('button');
      if (!target) return;

      // Heart button
      if (target.classList.contains('heart-btn')) {
        const heartIcon = target.querySelector('i');
        heartIcon.classList.remove('far');
        heartIcon.classList.add('fas', 'heart-animation');
        setTimeout(() => heartIcon.classList.remove('heart-animation'), 500);
        
        state.heartCount++;
        updateUI();
        saveToLocalStorage();
        return;
      }

      // Copy button
      if (target.classList.contains('copy-btn')) {
        const phone = target.getAttribute('data-phone');
        const name = target.getAttribute('data-name');
        
        try {
          await navigator.clipboard.writeText(phone);
          state.copyCount++;
          updateUI();
          saveToLocalStorage();
          showToast(`Copied: ${name} — ${phone}`);
        } catch (err) {
          showToast('Copy failed. Please try again.', true);
        }
        return;
      }

      // Call button
      if (target.classList.contains('call-btn')) {
        const phone = target.getAttribute('data-phone');
        const name = target.getAttribute('data-name');
        
        if (state.coinCount < 20) {
          showToast('Not enough coins. Need 20 coins to make a call.', true);
          return;
        }
        
        state.coinCount -= 20;
        updateUI();
        saveToLocalStorage();
        showToast(`Calling ${name} at ${phone}...`);
        addHistory(name, phone);
        return;
      }

      // Clear history button
      if (target.id === 'clearHistory') {
        state.callHistory = [];
        renderHistory();
        saveToLocalStorage();
        showToast('Call history cleared');
      }
    });

    // Initialize the app
    init();
  </script>
</body>

</html>
